#
# Auto-generated by jaxb2ruby v<%= @version %> on <%= Time.now %>
#

<%- @class.requires.each do |mod| -%>
require "<%= mod %>"
<%- end -%>

<%= @class.module.map { |mod| "module #{mod}" }.join " " %>

class <%= @class.name %>
  <%- nodes = (@class.element.children + @class.element.attributes) -%>
  <%- nodes.each do |attr| -%>
    attr_accessor :<%= attr.accessor %>
  <%- end -%>

  def initialize(attributes = {})
    <%- nodes.each do |node| -%>
      <%# what about string keys? %>
      <%- if node.array? -%>
        @<%= node.accessor %> = Array(attributes[:<%= node.accessor %>]).dup
      <%- elsif node.hash? -%>
        @<%= node.accessor %> = attributes[:<%= node.accessor %>].is_a?(Hash) ? attributes[:<%= node.accessor %>].dup : {}
      <%- elsif node.type == :boolean -%>
        <%# remove ending "?" %>
        @<%= node.accessor.chop %> = attributes[:<%= node.accessor.chop %>]
      <%- else -%>
        @<%= node.accessor %> = attributes[:<%= node.accessor %>]
      <%- end -%>
    <%- end -%>
  end

  def inspect
    # #<Class:0x0000 @name1=%s, @name2=%s ...>
    <%- n = [5, nodes.size].min %>
    <%- attribs = nodes.sort_by { |node| node.accessor }.take(n) %>
    <%#fix bools %>
    sprintf "#<%s:0x%x <%= attribs.map { |node| nodea.accessor }.join(", ") %>>", self.class.name, object_id, <%= attribs.map { |node| node.accessor }.join(", ") %>
  end
end

<%= @class.module.map { "end" }.join " " %>
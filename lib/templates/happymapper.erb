#
# Auto-generated by jaxb2ruby v<%= @version %> on <%= Time.now %>
# https://github.com/sshaw/jaxb2ruby
#

require "happymapper"

<%- @class.requires.each do |mod| -%>
require "<%= mod %>"
<%- end -%>

<%= @class.module.map { |mod| "module #{mod}" }.join " " %>

class <%= @class.name %> <%= "< #{@class.superclass}" if @class.superclass %>
  include HappyMapper

  <%- if @class.element.namespace -%>
    namespace "<%= @class.element.namespace %>"
  <%- end -%>

  tag "<%= @class.element.name %>"

  <%- @class.element.children.each do |e| -%>
    <%# if type is namespaced and ! an array we can use has_one %>
    <% next if e.type == :ID || e.type == :IDREF %>
    <%- type = e.type == :boolean ? Boolean : e.type -%>
    <%- if e.array? -%>
      has_many :<%= e.accessor %>, type, :tag => "<%= e.name %>", :namespace => "<%= e.namespace %>"

    <%- elsif e.type.include?("::") -%>
      has_one :<%= e.accessor %>, type, :tag => "<%= e.name %>", :namespace => "<%= e.namespace %>"

    <%- else -%>
      element :<%= e.accessor %>, type, :tag => "<%= e.name %>", :namespace => "<%= e.namespace %>"
    <%- end -%>
  <%- end -%>

  <%- if @class.element.text? -%>
    content :content
  <%- end -%>

  <% @class.element.attributes.each do |attr| %>
      attribute :<%= attr.accessor %>, <%= attr.type == :boolean ? Boolean : attr.type %>, :tag => "@<%= attr.name %>"
  <% end %>
end

<%= @class.module.map { "end" }.join " " %>
